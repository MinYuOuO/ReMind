import{A as a,B as h,C as I,D as T,F as b,G as m,H as p,P as S,R as d,S as P,Sa as G,T as k,Ta as L,Ua as F,V as R,Va as W,W as E,X as M,Ya as H,Za as K,bb as U,ea as V,eb as Y,fa as A,fb as j,ga as B,h as g,ha as O,i as f,ib as J,la as N,mb as Q,nb as X,o as y,p as o,pb as Z,s as C,ub as $,v as u,va as q,wa as D,y as c,z as r,za as z}from"./chunk-NFYGWNBG.js";import"./chunk-6675UF34.js";import"./chunk-ZHQITZWE.js";import"./chunk-NJ63EZW4.js";import"./chunk-DEDRJWY3.js";import"./chunk-RADHBB3Y.js";import"./chunk-JHFNTCF2.js";import"./chunk-4WFVMWDK.js";import"./chunk-LRFGNCHE.js";import"./chunk-M2X7KQLB.js";import"./chunk-OZYWYLNK.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-42C7ZIID.js";import{f as v}from"./chunk-MCHWYEYM.js";function te(i,l){if(i&1){let t=b();r(0,"ion-buttons",6)(1,"ion-button",7),m("click",function(){g(t);let e=p();return f(e.goBack())}),h(2,"ion-icon",8),a()()}}function ie(i,l){i&1&&h(0,"ion-spinner",18)}function ne(i,l){if(i&1&&(r(0,"ion-chip"),d(1),a()),i&2){let t=l.$implicit;o(),P(t)}}function oe(i,l){if(i&1){let t=b();r(0,"div",19)(1,"div",20),d(2,"Preview (8)"),a(),r(3,"div",21),u(4,ne,2,1,"ion-chip",22),a(),r(5,"ion-button",23),m("click",function(){g(t);let e=p(2);return f(e.view="roll")}),d(6,"Open Roulette"),a()()}if(i&2){let t=p(2);o(4),c("ngForOf",t.options)}}function re(i,l){if(i&1){let t=b();r(0,"section",9)(1,"div",10)(2,"div",11),d(3,"Ask a question"),a(),r(4,"ion-item",12),h(5,"ion-icon",13),r(6,"ion-textarea",14),M("ngModelChange",function(e){g(t);let s=p();return E(s.question,e)||(s.question=e),f(e)}),a()(),r(7,"ion-button",15),m("click",function(){g(t);let e=p();return f(e.generateWithAI())}),u(8,ie,1,0,"ion-spinner",16),d(9),a(),u(10,oe,7,1,"div",17),a()()}if(i&2){let t=p();o(6),R("ngModel",t.question),o(),c("disabled",t.isGenerating),o(),c("ngIf",t.isGenerating),o(),k(" ",t.isGenerating?"Thinking\u2026":"Generate with AI"," "),o(),c("ngIf",t.options==null?null:t.options.length)}}function ae(i,l){if(i&1&&(r(0,"li")(1,"div",35),h(2,"span",36),a()()),i&2){let t=l.$implicit,n=l.index,e=p(2);o(),S("--i",n),o(),c("innerHTML",e.toTwoLine(t),y)}}function se(i,l){i&1&&(r(0,"span"),d(1,"SPIN"),a())}function le(i,l){i&1&&(r(0,"span"),d(1,"\u2026"),a())}function ce(i,l){if(i&1){let t=b();r(0,"section",24)(1,"div",25)(2,"div",26),m("transitionend",function(e){g(t);let s=p();return f(s.onSpinEnd(e))}),r(3,"ul",27),u(4,ae,3,3,"li",22),a(),r(5,"button",28),m("click",function(){g(t);let e=p();return f(e.startRoll())}),u(6,se,2,0,"span",29)(7,le,2,0,"span",29),a(),h(8,"div",30)(9,"div",31),a(),h(10,"div",32),a(),r(11,"div",33),d(12),a(),r(13,"ion-button",34),m("click",function(){g(t);let e=p();return f(e.startRoll())}),d(14," Spin Again "),a()()}if(i&2){let t=p();o(2),S("transform","rotate("+t.spinDegrees+"deg)")("transition",t.transitionStyle),o(2),c("ngForOf",t.options),o(),c("disabled",t.isSpinning),o(),c("ngIf",!t.isSpinning),o(),c("ngIf",t.isSpinning),o(5),k(" ",t.isSpinning?"Rolling\u2026":t.resultText||"Tap SPIN to start"," ")}}X({chatbubblesOutline:$,arrowBack:Z});var be=(()=>{let l=class l{constructor(){this.view="ask",this.question="",this.isGenerating=!1,this.options=[],this.segmentAngle=45,this.isSpinning=!1,this.resultText="",this.selectedIndex=-1,this.spinDegrees=0,this.transitionStyle="transform 2.8s cubic-bezier(.2,.75,.2,1)"}goBack(){this.view="ask"}toTwoLine(n){let e=(n||"").trim().replace(/\s+/g," "),s=e.indexOf(" ");return s>0&&s<e.length-1?e.slice(0,s)+"<br>"+e.slice(s+1):e}useDefaults(){this.setOptions(["Coffee Shop","Cinema","Restaurant","Shopping Mall","Beach","Karaoke","Picnic Park","Night Market"]),this.view="roll"}generateWithAI(){return v(this,null,function*(){let n=(this.question||"").trim();if(!n){this.useDefaults();return}this.isGenerating=!0;try{let e=yield this.aiSuggestOptions(n);this.setOptions(e),this.view="roll"}catch(e){console.warn("AI fallback used:",e),this.useDefaults()}finally{this.isGenerating=!1}})}aiSuggestOptions(n){return v(this,null,function*(){let e=["Coffee Shop","Cinema","Restaurant","Shopping Mall","Beach","Karaoke","Picnic Park","Night Market","Board Games","Art Museum","Live Music","Bowling"],s=Math.max(3,Math.min(9,n.length%10));return[...e].sort((_,w)=>(_.charCodeAt(0)+s)%7-(w.charCodeAt(0)+s)%7).slice(0,8)})}setOptions(n){let e=(n||[]).map(x=>(x||"").trim()).filter(Boolean).filter((x,_,w)=>w.findIndex(ee=>ee.toLowerCase()===x.toLowerCase())===_),s=["Coffee Shop","Cinema","Restaurant","Shopping Mall","Beach","Karaoke","Picnic Park","Night Market"];for(;e.length<8;)e.push(s[e.length%s.length]);this.options=e.slice(0,8),this.segmentAngle=360/this.options.length,this.resultText="",this.selectedIndex=-1}startRoll(){if(this.options.length||this.useDefaults(),this.isSpinning)return;this.isSpinning=!0,this.resultText="";let n=Math.floor(Math.random()*this.options.length);this.selectedIndex=n;let e=n*this.segmentAngle+this.segmentAngle/2,s=5,x=360-e;this.spinDegrees=this.spinDegrees+s*360+x,window.setTimeout(()=>{this.isSpinning&&this.finishSpin()},3e3)}onSpinEnd(n){let e=n.target;!e||!e.classList.contains("wheel")||this.finishSpin()}finishSpin(){this.isSpinning=!1,this.resultText=this.options[this.selectedIndex]??"";try{navigator.vibrate?.(20)}catch{}}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=C({type:l,selectors:[["app-roulette"]],decls:9,vars:5,consts:[[1,"page-toolbar"],["slot","start",4,"ngIf"],[1,"page",3,"fullscreen"],[3,"ngSwitch"],["class","screen ask-screen",4,"ngSwitchCase"],["class","screen roll-screen",4,"ngSwitchCase"],["slot","start"],["fill","clear","aria-label","Back",3,"click"],["name","arrow-back"],[1,"screen","ask-screen"],[1,"question-card","glass"],[1,"q-title"],["lines","none",1,"field-card"],["name","chatbubbles-outline","slot","start",1,"field-icon"],["autoGrow","true","placeholder","e.g. What should we do this afternoon?","inputmode","text",3,"ngModelChange","ngModel"],["expand","block",1,"primary-btn",3,"click","disabled"],["name","crescent","style","margin-right: 8px",4,"ngIf"],["class","preview",4,"ngIf"],["name","crescent",2,"margin-right","8px"],[1,"preview"],[1,"preview-title"],[1,"chips"],[4,"ngFor","ngForOf"],["expand","block",1,"primary-btn",3,"click"],[1,"screen","roll-screen"],[1,"wheel-wrap"],[1,"wheel",3,"transitionend"],[1,"labels"],[1,"spin-btn",3,"click","disabled"],[4,"ngIf"],[1,"rim"],[1,"shine"],["aria-hidden","true",1,"pointer"],[1,"banner"],["expand","block","fill","clear",1,"secondary-btn",3,"click"],[1,"anchor"],[1,"text",3,"innerHTML"]],template:function(e,s){e&1&&(r(0,"ion-header")(1,"ion-toolbar",0),u(2,te,3,0,"ion-buttons",1),r(3,"ion-title"),d(4,"Roulette"),a()()(),r(5,"ion-content",2),I(6,3),u(7,re,11,5,"section",4)(8,ce,15,9,"section",5),T(),a()),e&2&&(o(2),c("ngIf",s.view!=="ask"),o(3),c("fullscreen",!0),o(),c("ngSwitch",s.view),o(),c("ngSwitchCase","ask"),o(),c("ngSwitchCase","roll"))},dependencies:[N,V,A,B,O,z,q,D,H,j,Y,W,L,G,J,K,Q,F,U],styles:[`@charset "UTF-8";.page{--background: linear-gradient(180deg, #9fb7d6 0%, #eaf1f8 60%, #ffffff 100%)}.page-toolbar{background:linear-gradient(180deg,#9fb7d6,#b8c9de);color:#fff}.page-toolbar ion-title{font-weight:800;text-align:center}.page-toolbar ion-icon{color:#fff;font-size:20px}.primary-btn{--background: #5d78b0;--border-radius: 12px;color:#fff;font-weight:700;margin:20px}.secondary-btn{--border-radius: 12px;font-weight:700}.q-title{color:#6b7aa6;font-weight:700;margin-bottom:8px}.q-input{color:#1e3a8a;font-weight:800;font-size:16px}.preview{padding:10px;background-color:#6281bceb;border-radius:12px}.preview-title{margin:10px;font-weight:600}.chips{margin:20px;color:#789}.banner{margin-top:12px;align-self:center;min-width:240px;background:#6281bceb;color:#fff;font-weight:800;border-radius:12px;padding:12px 18px;text-align:center;box-shadow:0 10px 22px #2640782e}.field-card{--background: #ffffff;--color: #1e3a8a;border-radius:12px;border:1px solid #dce3f1;margin:10px 0;align-items:center}.field-card ion-icon{color:#6b7aa6!important}.field-card ion-input,.field-card ion-select{color:#1e3a8a;font-weight:700}.field-card ion-select::part(text),.field-card ion-input::part(native){--placeholder-color: rgba(30,58,138,.45)}.screen{padding:80px 16px 16px;display:flex;flex-direction:column;gap:16px}.wheel-wrap{position:relative;margin:8px auto 0;width:min(80vw,360px);aspect-ratio:1/1;display:grid;place-items:center}.pointer{position:absolute;top:-8px;left:50%;transform:translate(-50%);width:0;height:0;border-left:12px solid transparent;border-right:12px solid transparent;border-bottom:20px solid #23417f;filter:drop-shadow(0 6px 10px rgba(32,54,96,.25));z-index:3}.wheel{position:relative;width:100%;height:100%;border-radius:50%;background:conic-gradient(#8fb0d9 0 45deg,#7398ca 45deg 90deg,#8fb0d9 90deg 135deg,#7398ca 135deg 180deg,#8fb0d9 180deg 225deg,#7398ca 225deg 270deg,#8fb0d9 270deg 315deg,#7398ca 315deg 360deg);border:14px solid rgba(46,77,147,.25);box-shadow:inset 0 0 0 6px #ffffff59,0 18px 36px #20366040;overflow:hidden;will-change:transform}.rim{position:absolute;inset:10%;border-radius:50%;box-shadow:inset 0 0 0 2px #fff9,inset 0 0 0 12px #ffffff1a;pointer-events:none}.shine{position:absolute;inset:0;border-radius:50%;pointer-events:none;background:radial-gradient(60% 60% at 30% 25%,rgba(255,255,255,.28),transparent 60%)}.labels{position:absolute;inset:0;margin:0;padding:0;list-style:none;z-index:2}.labels li{position:absolute;inset:0}.labels .anchor{position:absolute;left:50%;top:50%;width:100%;height:100%;transform:translate(-50%,-50%) rotate(calc(var(--i) * 45deg));transform-origin:center;pointer-events:none}.labels .text{position:absolute;left:35%;top:50%;transform:translateY(-50%) rotate(calc(var(--i) * -45deg));width:160px;line-height:1.15;font-weight:800;font-size:14px;color:#193b7a;text-align:center;display:block;-webkit-user-select:none;user-select:none}@media (min-width: 420px){.labels .text{width:180px;font-size:15px}}.spin-btn{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:108px;height:108px;border-radius:50%;border:0;cursor:pointer;background:#fff;color:#27478f;font-weight:900;letter-spacing:.5px;font-size:18px;box-shadow:0 10px 22px #2640782e,inset 0 4px 10px #ffffffb3;transition:transform .12s ease,box-shadow .12s ease}.spin-btn:active{transform:translate(-50%,-50%) scale(.98)}.spin-btn:disabled{opacity:.7;cursor:default}
`],encapsulation:2});let i=l;return i})();export{be as RoulettePage};
