import{a as z,b as G,j as I}from"./chunk-PBX6TMYL.js";import{b as K}from"./chunk-7H446SA7.js";import{A as f,Aa as D,Ba as L,Ca as N,Da as j,Ea as k,Fa as A,G as O,Ga as B,H as g,Ha as V,I as v,Ia as q,La as H,Ma as W,P as m,Pa as Y,Q as C,R as P,V as F,W as M,Y as R,d as u,e as _,h as w,i as E,ia as U,k as y,o as l,p as h,r as x,u as b,x as p,y as r,z as a,za as T}from"./chunk-NG5PLNHD.js";import"./chunk-BE2DWS65.js";import"./chunk-AMTPKJHQ.js";import"./chunk-KKEXG2WM.js";import"./chunk-O6ZQRTNC.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-F72A4HGE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as c}from"./chunk-JHI3MBHO.js";var S=K("Preferences",{web:()=>import("./chunk-QTEUTAVT.js").then(e=>new e.PreferencesWeb)});var $="remind.user_id",nt=()=>crypto?.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2),Q=(()=>{let t=class t{constructor(i){this.db=i}ensureUserId(){return c(this,null,function*(){let i=yield S.get({key:$});if(i.value)return i.value;let n=nt();return yield this.db.run(`INSERT OR IGNORE INTO user (user_id, username, contact_detail, birthday, notes)
       VALUES (?, ?, ?, ?, ?)`,[n,"","",null,""]),yield S.set({key:$,value:n}),n})}};t.\u0275fac=function(n){return new(n||t)(_(I))},t.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var X=()=>new Date().toISOString(),ot=()=>crypto?.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2),Z=(()=>{let t=class t{constructor(i){this.db=i}listByUser(i){return this.db.query("SELECT * FROM contact WHERE user_id = ? ORDER BY name COLLATE NOCASE ASC",[i])}createMinimal(i,n,s="friend"){return c(this,null,function*(){let o={contact_id:ot(),user_id:i,name:n,relationship:s,contact_detail:null,birthday:null,created_at:X(),updated_at:X(),notes:null};return yield this.db.run(`INSERT INTO contact (contact_id,user_id,name,relationship,contact_detail,birthday,created_at,updated_at,notes)
       VALUES (?,?,?,?,?,?,?,?,?)`,[o.contact_id,o.user_id,o.name,o.relationship,o.contact_detail,o.birthday,o.created_at,o.updated_at,o.notes]),o})}};t.\u0275fac=function(n){return new(n||t)(_(I))},t.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function at(e,t){if(e&1){let d=O();r(0,"div",8),f(1,"img",9),r(2,"h2"),m(3,"No friends yet"),a(),r(4,"p"),m(5,"Start by adding someone you care about."),a(),r(6,"ion-fab-button",6),g("click",function(){w(d);let n=v();return E(n.onAdd())}),m(7,"Add a friend"),a()()}}function st(e,t){if(e&1&&(r(0,"ion-item")(1,"ion-label")(2,"h2"),m(3),a(),r(4,"p"),m(5),a()()()),e&2){let d=t.$implicit;l(3),C(d.name),l(2),P("",d.relationship," \xB7 ",d.contact_detail||"no contact")}}function ct(e,t){if(e&1&&(r(0,"ion-list"),b(1,st,6,3,"ion-item",10),a()),e&2){let d=v();l(),p("ngForOf",d.contacts())}}var wt=(()=>{let t=class t{constructor(i,n,s){this.platform=i,this.identity=n,this.contactsRepo=s,this.userId="",this.loading=y(!0),this.contacts=y([]),z({add:G})}ngOnInit(){return c(this,null,function*(){yield this.platform.ready(),yield this.initUser(),yield this.load()})}initUser(){return c(this,null,function*(){this.userId=yield this.identity.ensureUserId()})}load(i){return c(this,null,function*(){try{this.loading.set(!0);let n=yield this.contactsRepo.listByUser(this.userId);this.contacts.set(n)}finally{this.loading.set(!1),i?.target?.complete?.()}})}addSample(){return c(this,null,function*(){yield this.contactsRepo.createMinimal(this.userId,"New Friend"),yield this.load()})}onAdd(){this.addSample()}};t.\u0275fac=function(n){return new(n||t)(h(U),h(Q),h(Z))},t.\u0275cmp=x({type:t,selectors:[["app-friend-list"]],decls:13,vars:3,consts:[["slot","end"],[1,"ion-padding",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["class","empty",4,"ngIf"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"click"],["name","add"],[1,"empty"],["src","assets/empty-friends.svg","alt","No friends"],[4,"ngFor","ngForOf"]],template:function(n,s){n&1&&(r(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),m(3,"Friends"),a(),f(4,"ion-buttons",0),a()(),r(5,"ion-content",1)(6,"ion-refresher",2),g("ionRefresh",function(tt){return s.load(tt)}),f(7,"ion-refresher-content"),a(),b(8,at,8,0,"div",3)(9,ct,2,1,"ion-list",4),r(10,"ion-fab",5)(11,"ion-fab-button",6),g("click",function(){return s.onAdd()}),f(12,"ion-icon",7),a()()()),n&2&&(l(5),p("fullscreen",!0),l(3),p("ngIf",!s.loading()&&s.contacts().length===0),l(),p("ngIf",s.contacts().length>0))},dependencies:[R,F,M,j,W,H,T,D,B,k,A,V,q,L,N,Y],styles:[".empty[_ngcontent-%COMP%]{margin-top:10vh;text-align:center}.empty[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:160px;opacity:.7;margin-bottom:1rem}.empty[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:.25rem 0}.empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:1rem}"]});let e=t;return e})();export{wt as FriendListPage};
