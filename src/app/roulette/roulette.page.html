<!-- roulette.page.html ✅ 仅此一套结构 -->

<ion-header>
  <ion-toolbar class="page-toolbar">
    <ion-buttons slot="start" *ngIf="view !== 'ask'">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Roulette</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="page">
  <!-- 视图切换：ask | roll | result -->
  <ng-container [ngSwitch]="view">

    <!-- ① 提问视图 -->
    <section *ngSwitchCase="'ask'" class="screen ask-screen">
      <div class="chip-row">
        <div class="chip">
          <ion-icon name="chatbubbles-outline"></ion-icon>
          <span>Suggestion Given</span>
        </div>
        <ion-button fill="clear" size="small" class="chip-close">
          <ion-icon name="close-outline"></ion-icon>
        </ion-button>
      </div>

      <div class="question-card">
        <div class="q-title">Suggestion:</div>
        <div class="q-input">{{ question || 'Where can go ?' }}</div>
      </div>

      <ion-button class="primary-btn" expand="block" (click)="view='roll'">
        Open Roulette
      </ion-button>
    </section>

    <!-- ② 旋转视图 -->
    <section *ngSwitchCase="'roll'" class="screen roll-screen">
      <div class="wheel-wrap">
        <div class="wheel" [class.spinning]="isSpinning">
          <ul class="labels">
            <li style="--i:0">Coffee<br/>Shop</li>
            <li style="--i:1">Cinema</li>
            <li style="--i:2">Restaurant</li>
            <li style="--i:3">Shopping<br/>Mall</li>
            <li style="--i:4">Beach</li>
            <li style="--i:5">Karaoke</li>
            <li style="--i:6">Picnic<br/>park</li>
            <li style="--i:7">Night<br/>market</li>
          </ul>
          <div class="wheel-shadow"></div>
        </div>
        <div class="pointer"></div>
      </div>

      <div class="banner">
        {{ isSpinning ? 'Rolling...' : (resultText || 'Tap SPIN to start') }}
      </div>

      <ion-button class="primary-btn" expand="block" (click)="startRoll()">SPIN</ion-button>
      <ion-button fill="clear" expand="block" (click)="view='result'" [disabled]="!resultText">
        View Result
      </ion-button>
    </section>

    <!-- ③ 结果视图 -->
    <section *ngSwitchCase="'result'" class="screen result-screen">
      <div class="pill">{{ question || 'Where can go ?' }}</div>

      <div class="wheel-wrap">
        <div class="wheel">
          <ul class="labels">
            <li style="--i:0">Coffee<br/>Shop</li>
            <li style="--i:1">Cinema</li>
            <li style="--i:2">Restaurant</li>
            <li style="--i:3">Shopping<br/>Mall</li>
            <li style="--i:4">Beach</li>
            <li style="--i:5">Karaoke</li>
            <li style="--i:6">Picnic<br/>park</li>
            <li style="--i:7">Night<br/>market</li>
          </ul>
          <div class="wheel-shadow"></div>
        </div>
        <div class="pointer"></div>
      </div>

      <div class="result-card">{{ resultText || 'Night Market' }}</div>
      <ion-button class="primary-btn" expand="block" (click)="view='roll'">Spin Again</ion-button>
    </section>
  </ng-container>
</ion-content>
