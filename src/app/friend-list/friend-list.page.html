<ion-header>
  <ion-toolbar class="page-toolbar">
    <ion-title>Home</ion-title>

    <ion-buttons slot="end">
      <ion-button fill="clear">
        <ion-icon name="notifications-outline"></ion-icon>
      </ion-button>
      <ion-button fill="clear">
        <ion-icon name="shield-checkmark-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="page">

  <!-- Search -->
  <div class="search-container">
    <ion-searchbar placeholder="Search" class="search"></ion-searchbar>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading() && contacts().length === 0" class="empty">
    <img src="assets/add-friend.svg" alt="No friends" />
    <h2>No friends yet</h2>
    <p>Start by adding someone you care about.</p>
  </div>

  <!-- Friend list -->
  <ion-list *ngIf="contacts().length > 0" class="contacts-list">
    <ion-item *ngFor="let c of contacts(); trackBy: trackById"
              class="contact-card" lines="none" button (click)="openEdit(c)">
      <div slot="start" class="avatar">
        <ion-icon name="person-outline"></ion-icon>
      </div>
      <ion-label class="main-label">
        <h2 class="name">{{ c.name }}</h2>
        <p class="meta">{{ c.relationship || 'Friend' }}</p>
      </ion-label>
    </ion-item>
  </ion-list>

  <!-- Add button -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button class="fab-add" (click)="onAdd()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Add/Edit Modal -->
  <ion-modal [isOpen]="showModal()" cssClass="friend-modal">
    <ng-template>
      <div class="edit-screen">

        <ion-header>
          <ion-toolbar class="edit-toolbar">
            <ion-buttons slot="start">
              <ion-button (click)="onCancel()">
                <ion-icon name="arrow-back"></ion-icon>
              </ion-button>
            </ion-buttons>
            <ion-title class="edit-title">Friend</ion-title>
          </ion-toolbar>
        </ion-header>

        <ion-content class="edit-content">
          <div class="profile-area">
            <div class="profile-camera">
              <ion-icon name="camera"></ion-icon>
            </div>
            <div class="offline-label">Recorded Offline</div>
          </div>

          <ion-list class="fields-list">
            <ion-item class="field-card" lines="none">
              <ion-icon slot="start" name="person-outline" class="field-icon"></ion-icon>
              <ion-input placeholder="Name" [(ngModel)]="newContact.name"></ion-input>
            </ion-item>

            <ion-item class="field-card" lines="none">
              <ion-icon slot="start" name="briefcase-outline" class="field-icon"></ion-icon>
              <ion-select interface="action-sheet" placeholder="Relationship"
                          [(ngModel)]="newContact.relationship">
                <ion-select-option *ngFor="let rel of relationships" [value]="rel">
                  {{ rel | titlecase }}
                </ion-select-option>
              </ion-select>
              <ion-icon slot="end" name="star-outline" class="rating-icon"></ion-icon>
            </ion-item>

            <ion-item class="field-card" lines="none">
              <ion-icon slot="start" name="call-outline" class="field-icon"></ion-icon>
              <ion-input placeholder="Contact Details"
                         [(ngModel)]="newContact.contact_detail"></ion-input>
            </ion-item>

            <ion-item class="field-card date-field" lines="none" (click)="toggleCalendar()">
              <ion-icon slot="start" name="calendar-outline" class="field-icon"></ion-icon>
              <ion-label class="date-label">
                {{ newContact.birthday ? (newContact.birthday | date:'MMM d, y') : 'Birthday' }}
              </ion-label>
            </ion-item>

            <!-- Inline calendar -->
            <div *ngIf="calendarOpen" class="inline-calendar">
              <div class="cal-header">
                <button class="cal-nav" (click)="prevMonth()">‹</button>
                <div class="cal-title">{{ monthNames[calMonth] }} {{ calYear }}</div>
                <button class="cal-nav" (click)="nextMonth()">›</button>
              </div>

              <div class="cal-weekdays">
                <div *ngFor="let d of weekdayNames">{{ d }}</div>
              </div>

              <div class="cal-grid">
                <div *ngFor="let cell of calendarCells"
                     class="cal-cell"
                     [class.empty]="!cell"
                     [class.selected]="cell && isSelectedDay(cell)"
                     (click)="cell && selectDay(cell)">
                  <span *ngIf="cell">{{ cell }}</span>
                </div>
              </div>

              <div class="cal-actions">
                <ion-button fill="clear" size="small" (click)="toggleCalendar(false)">Close</ion-button>
              </div>
            </div>
          </ion-list>
        </ion-content>

        <div class="save-footer">
          <ion-button expand="block" class="save-btn" (click)="onSubmit()">
            <ion-icon name="save"></ion-icon>
          </ion-button>
        </div>
      </div>
    </ng-template>
  </ion-modal>

</ion-content>

<ion-header>
  <ion-toolbar class="page-toolbar">
    <ion-buttons slot="start">
      <ion-button routerLink="/home">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Interaction Add</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="page">

  <section class="form-wrap">

    <!-- 主题 -->
    <ion-item lines="none" class="field-card">
      <ion-icon name="chatbubbles-outline" slot="start" class="field-icon"></ion-icon>
      <ion-input
        placeholder="What’s the topic?"
        [(ngModel)]="topic"
        inputmode="text">
      </ion-input>
      <ion-icon name="chevron-down-outline" slot="end" class="ghost"></ion-icon>
    </ion-item>

    <!-- 日期 -->
    <ion-item lines="none" class="field-card" (click)="datePicker?.open()">
      <ion-icon name="calendar-outline" slot="start" class="field-icon"></ion-icon>
      <ion-datetime-button datetime="dt1"></ion-datetime-button>
      <ion-modal keepContentsMounted="true">
        <ng-template>
          <ion-datetime id="dt1" #datePicker [(ngModel)]="date" presentation="date"></ion-datetime>
        </ng-template>
      </ion-modal>
    </ion-item>

    <!-- 联系人 -->
    <ion-item lines="none" class="field-card">
      <ion-icon name="person-outline" slot="start" class="field-icon"></ion-icon>
      <ion-select [(ngModel)]="selectedContact" interface="action-sheet" placeholder="Contact">
        <ion-select-option *ngFor="let c of contactOptions" [value]="c">{{ c }}</ion-select-option>
      </ion-select>
    </ion-item>

    <!-- 原始笔记 -->
    <ion-item lines="none" class="field-card textarea">
      <ion-icon name="create-outline" slot="start" class="field-icon"></ion-icon>
      <ion-textarea
        auto-grow="true"
        placeholder="Raw Notes"
        [(ngModel)]="rawNotes">
      </ion-textarea>
    </ion-item>

    <!-- 发送按钮 -->
    <ion-button class="primary-btn send-btn" expand="block" (click)="onGenerate()">
      <ion-icon name="paper-plane-outline" slot="start"></ion-icon>
      Generate
    </ion-button>

  </section>

  <!-- 底部导航（装饰/可替换为 ion-tabs） -->
  <ion-footer class="tabs">
    <div class="tab"><ion-icon name="home-outline"></ion-icon><span>Home</span></div>
    <div class="tab"><ion-icon name="git-network-outline"></ion-icon><span>RSearch</span></div>
    <div class="tab active"><ion-icon name="aperture-outline"></ion-icon><span>Roulette</span></div>
    <div class="tab"><ion-icon name="settings-outline"></ion-icon><span>Setting</span></div>
  </ion-footer>
</ion-content>